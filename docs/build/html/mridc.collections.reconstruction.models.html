<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mridc.collections.reconstruction.models package &mdash; mridc v.0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mridc.collections.reconstruction.models.cascadenet package" href="mridc.collections.reconstruction.models.cascadenet.html" />
    <link rel="prev" title="mridc.collections.reconstruction.metrics package" href="mridc.collections.reconstruction.metrics.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> mridc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">mridc</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mridc.html">mridc package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="mridc.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="mridc.collections.html">mridc.collections package</a></li>
<li class="toctree-l4"><a class="reference internal" href="mridc.core.html">mridc.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="mridc.utils.html">mridc.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mridc.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mridc.html#module-mridc.constants">mridc.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mridc.html#module-mridc.launch">mridc.launch module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mridc.html#module-mridc.package_info">mridc.package_info module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mridc.html#module-mridc">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mridc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">mridc</a> &raquo;</li>
          <li><a href="mridc.html">mridc package</a> &raquo;</li>
          <li><a href="mridc.collections.html">mridc.collections package</a> &raquo;</li>
          <li><a href="mridc.collections.reconstruction.html">mridc.collections.reconstruction package</a> &raquo;</li>
      <li>mridc.collections.reconstruction.models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mridc.collections.reconstruction.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="mridc-collections-reconstruction-models-package">
<h1>mridc.collections.reconstruction.models package<a class="headerlink" href="#mridc-collections-reconstruction-models-package" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.cascadenet.html">mridc.collections.reconstruction.models.cascadenet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.cascadenet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.cascadenet.html#module-mridc.collections.reconstruction.models.cascadenet.ccnn_block">mridc.collections.reconstruction.models.cascadenet.ccnn_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.cascadenet.html#module-mridc.collections.reconstruction.models.cascadenet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.conv.html">mridc.collections.reconstruction.models.conv package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.conv.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.conv.html#module-mridc.collections.reconstruction.models.conv.conv2d">mridc.collections.reconstruction.models.conv.conv2d module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.conv.html#module-mridc.collections.reconstruction.models.conv.gruconv2d">mridc.collections.reconstruction.models.conv.gruconv2d module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.conv.html#module-mridc.collections.reconstruction.models.conv">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.convrecnet.html">mridc.collections.reconstruction.models.convrecnet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.convrecnet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.convrecnet.html#module-mridc.collections.reconstruction.models.convrecnet.crnn_block">mridc.collections.reconstruction.models.convrecnet.crnn_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.convrecnet.html#module-mridc.collections.reconstruction.models.convrecnet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.crossdomain.html">mridc.collections.reconstruction.models.crossdomain package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.crossdomain.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.crossdomain.html#module-mridc.collections.reconstruction.models.crossdomain.crossdomain">mridc.collections.reconstruction.models.crossdomain.crossdomain module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.crossdomain.html#module-mridc.collections.reconstruction.models.crossdomain.multicoil">mridc.collections.reconstruction.models.crossdomain.multicoil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.crossdomain.html#module-mridc.collections.reconstruction.models.crossdomain">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.didn.html">mridc.collections.reconstruction.models.didn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.didn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.didn.html#module-mridc.collections.reconstruction.models.didn.didn">mridc.collections.reconstruction.models.didn.didn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.didn.html#module-mridc.collections.reconstruction.models.didn">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.multidomain.html">mridc.collections.reconstruction.models.multidomain package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.multidomain.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.multidomain.html#module-mridc.collections.reconstruction.models.multidomain.multidomain">mridc.collections.reconstruction.models.multidomain.multidomain module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.multidomain.html#module-mridc.collections.reconstruction.models.multidomain">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.mwcnn.html">mridc.collections.reconstruction.models.mwcnn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.mwcnn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.mwcnn.html#module-mridc.collections.reconstruction.models.mwcnn.mwcnn">mridc.collections.reconstruction.models.mwcnn.mwcnn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.mwcnn.html#module-mridc.collections.reconstruction.models.mwcnn">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.primaldual.html">mridc.collections.reconstruction.models.primaldual package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.primaldual.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.primaldual.html#module-mridc.collections.reconstruction.models.primaldual.pd">mridc.collections.reconstruction.models.primaldual.pd module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.primaldual.html#module-mridc.collections.reconstruction.models.primaldual">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.recurrentvarnet.html">mridc.collections.reconstruction.models.recurrentvarnet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.recurrentvarnet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.recurrentvarnet.html#module-mridc.collections.reconstruction.models.recurrentvarnet.conv2gru">mridc.collections.reconstruction.models.recurrentvarnet.conv2gru module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.recurrentvarnet.html#module-mridc.collections.reconstruction.models.recurrentvarnet.recurentvarnet">mridc.collections.reconstruction.models.recurrentvarnet.recurentvarnet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.recurrentvarnet.html#module-mridc.collections.reconstruction.models.recurrentvarnet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html">mridc.collections.reconstruction.models.rim package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#module-mridc.collections.reconstruction.models.rim.conv_layers">mridc.collections.reconstruction.models.rim.conv_layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#module-mridc.collections.reconstruction.models.rim.rim_block">mridc.collections.reconstruction.models.rim.rim_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#module-mridc.collections.reconstruction.models.rim.rnn_cells">mridc.collections.reconstruction.models.rim.rnn_cells module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#module-mridc.collections.reconstruction.models.rim.utils">mridc.collections.reconstruction.models.rim.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.rim.html#module-mridc.collections.reconstruction.models.rim">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.sigmanet.html">mridc.collections.reconstruction.models.sigmanet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.sigmanet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.sigmanet.html#module-mridc.collections.reconstruction.models.sigmanet.dc_layers">mridc.collections.reconstruction.models.sigmanet.dc_layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.sigmanet.html#module-mridc.collections.reconstruction.models.sigmanet.sensitivity_net">mridc.collections.reconstruction.models.sigmanet.sensitivity_net module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.sigmanet.html#module-mridc.collections.reconstruction.models.sigmanet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.unet_base.html">mridc.collections.reconstruction.models.unet_base package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.unet_base.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.unet_base.html#module-mridc.collections.reconstruction.models.unet_base.unet_block">mridc.collections.reconstruction.models.unet_base.unet_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.unet_base.html#module-mridc.collections.reconstruction.models.unet_base">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.variablesplittingnet.html">mridc.collections.reconstruction.models.variablesplittingnet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.variablesplittingnet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.variablesplittingnet.html#module-mridc.collections.reconstruction.models.variablesplittingnet.vsnet_block">mridc.collections.reconstruction.models.variablesplittingnet.vsnet_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.variablesplittingnet.html#module-mridc.collections.reconstruction.models.variablesplittingnet">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mridc.collections.reconstruction.models.varnet.html">mridc.collections.reconstruction.models.varnet package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.varnet.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.varnet.html#module-mridc.collections.reconstruction.models.varnet.vn_block">mridc.collections.reconstruction.models.varnet.vn_block module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mridc.collections.reconstruction.models.varnet.html#module-mridc.collections.reconstruction.models.varnet">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-mridc.collections.reconstruction.models.base">
<span id="mridc-collections-reconstruction-models-base-module"></span><h2>mridc.collections.reconstruction.models.base module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.base" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.base.</span></span><span class="sig-name descname"><span class="pre">BaseMRIReconstructionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="mridc.core.classes.html#mridc.core.classes.modelPT.ModelPT" title="mridc.core.classes.modelPT.ModelPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.core.classes.modelPT.ModelPT</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class of all MRIReconstruction models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.log_image">
<span class="sig-name descname"><span class="pre">log_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.log_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.log_image" title="Permalink to this definition"></a></dt>
<dd><p>Logs an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>Name of the image.</em>) – str</p></li>
<li><p><strong>image</strong> (<em>Image to log.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.process_inputs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.process_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.process_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Processes the inputs to the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – list of torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – list of torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – list of torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – randomly selected y</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – randomly selected mask</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – randomly selected init_pred</p></li>
<li><p><strong>r</strong> (<em>Random index.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.process_loss">
<span class="sig-name descname"><span class="pre">process_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_loss_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.process_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.process_loss" title="Permalink to this definition"></a></dt>
<dd><p>Processes the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>Target data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>pred</strong> (<em>Final prediction</em><em>(</em><em>s</em><em>)</em><em>.</em>) – list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or
torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>_loss_fn</strong> (<em>Loss function.</em>) – torch.nn.Module, default torch.nn.L1Loss()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>loss</strong> – If self.accumulate_loss is True, returns an accumulative result of all intermediate losses.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.FloatTensor, shape [1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_test_data">
<span class="sig-name descname"><span class="pre">setup_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_data_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">omegaconf.dictconfig.DictConfig</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.setup_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_test_data" title="Permalink to this definition"></a></dt>
<dd><p>Setups the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_data_config</strong> (<em>Test data configuration.</em>) – dict</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>test_data</strong> – torch.utils.data.DataLoader</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Test data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_training_data">
<span class="sig-name descname"><span class="pre">setup_training_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">omegaconf.dictconfig.DictConfig</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.setup_training_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_training_data" title="Permalink to this definition"></a></dt>
<dd><p>Setups the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>train_data_config</strong> (<em>Training data configuration.</em>) – dict</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>train_data</strong> – torch.utils.data.DataLoader</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Training data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_validation_data">
<span class="sig-name descname"><span class="pre">setup_validation_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_data_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">omegaconf.dictconfig.DictConfig</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.setup_validation_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.setup_validation_data" title="Permalink to this definition"></a></dt>
<dd><p>Setups the validation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val_data_config</strong> (<em>Validation data configuration.</em>) – dict</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>val_data</strong> – torch.utils.data.DataLoader</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Validation data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.test_epoch_end">
<span class="sig-name descname"><span class="pre">test_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.test_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.test_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Called at the end of test epoch to aggregate outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputs</strong> (<em>List of outputs of the test batches.</em>) – list of dicts</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Saves the reconstructed images to .h5 files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a test step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Batch of data. Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>with keys</em><em>,</em>) – <dl class="simple">
<dt>‘y’: subsampled kspace,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’sensitivity_maps’: sensitivity_maps,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’mask’: sampling mask,</dt><dd><p>torch.Tensor, shape [1, 1, n_x, n_y, 1]</p>
</dd>
<dt>’init_pred’: initial prediction. For example zero-filled or PICS.</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’target’: target data,</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’fname’: filename,</dt><dd><p>str, shape [batch_size]</p>
</dd>
<dt>’slice_idx’: slice_idx,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’acc’: acceleration factor,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’max_value’: maximum value of the magnitude image space,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’crop_size’: crop size,</dt><dd><p>torch.Tensor, shape [n_x, n_y]</p>
</dd>
</dl>
</p></li>
<li><p><strong>batch_idx</strong> (<em>Batch index.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>name</strong> (<em>Name of the volume.</em>) – str</p></li>
<li><p><strong>slice_num</strong> (<em>Slice number.</em>) – int</p></li>
<li><p><strong>pred</strong> (<em>Predicted data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.training_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a training step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Batch of data.</em>) – <p>Dict[str, torch.Tensor], with keys,</p>
<dl class="simple">
<dt>’y’: subsampled kspace,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’sensitivity_maps’: sensitivity_maps,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’mask’: sampling mask,</dt><dd><p>torch.Tensor, shape [1, 1, n_x, n_y, 1]</p>
</dd>
<dt>’init_pred’: initial prediction. For example zero-filled or PICS.</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’target’: target data,</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’fname’: filename,</dt><dd><p>str, shape [batch_size]</p>
</dd>
<dt>’slice_idx’: slice_idx,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’acc’: acceleration factor,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’max_value’: maximum value of the magnitude image space,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’crop_size’: crop size,</dt><dd><p>torch.Tensor, shape [n_x, n_y]</p>
</dd>
</dl>
</p></li>
<li><p><strong>batch_idx</strong> (<em>Batch index.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Dict[str, torch.Tensor], with keys,</em></p></li>
<li><p><strong>’loss’</strong> (<em>loss,</em>) – torch.Tensor, shape [1]</p></li>
<li><p><strong>’log’</strong> (<em>log,</em>) – dict, shape [1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.validation_epoch_end">
<span class="sig-name descname"><span class="pre">validation_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.validation_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Called at the end of validation epoch to aggregate outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputs</strong> (<em>List of outputs of the validation batches.</em>) – list of dicts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>metrics</strong> – dict</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dictionary of metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseMRIReconstructionModel.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel.validation_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a validation step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Batch of data. Dict</em><em>[</em><em>str</em><em>, </em><em>torch.Tensor</em><em>]</em><em>, </em><em>with keys</em><em>,</em>) – <dl class="simple">
<dt>‘y’: subsampled kspace,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’sensitivity_maps’: sensitivity_maps,</dt><dd><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt>’mask’: sampling mask,</dt><dd><p>torch.Tensor, shape [1, 1, n_x, n_y, 1]</p>
</dd>
<dt>’init_pred’: initial prediction. For example zero-filled or PICS.</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’target’: target data,</dt><dd><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
<dt>’fname’: filename,</dt><dd><p>str, shape [batch_size]</p>
</dd>
<dt>’slice_idx’: slice_idx,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’acc’: acceleration factor,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’max_value’: maximum value of the magnitude image space,</dt><dd><p>torch.Tensor, shape [batch_size]</p>
</dd>
<dt>’crop_size’: crop size,</dt><dd><p>torch.Tensor, shape [n_x, n_y]</p>
</dd>
</dl>
</p></li>
<li><p><strong>batch_idx</strong> (<em>Batch index.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Dict[str, torch.Tensor], with keys,</em></p></li>
<li><p><strong>’loss’</strong> (<em>loss,</em>) – torch.Tensor, shape [1]</p></li>
<li><p><strong>’log’</strong> (<em>log,</em>) – dict, shape [1]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.base.</span></span><span class="sig-name descname"><span class="pre">BaseSensitivityModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_chans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_chans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'2D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'orthogonal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Model for learning sensitivity estimation from k-space data.
This model applies an IFFT to multichannel k-space data and then a U-Net to the coil images to estimate coil
sensitivities.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.batch_chans_to_chan_dim">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_chans_to_chan_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel.batch_chans_to_chan_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.batch_chans_to_chan_dim" title="Permalink to this definition"></a></dt>
<dd><p>Converts the number of channels in a tensor to the channel dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor to convert.</em>) – torch.Tensor</p></li>
<li><p><strong>batch_size</strong> (<em>Original batch size.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Converted tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.chans_to_batch_dim">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chans_to_batch_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel.chans_to_batch_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.chans_to_batch_dim" title="Permalink to this definition"></a></dt>
<dd><p>Converts the number of channels in a tensor to the batch dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor to convert.</em>) – torch.Tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple[torch.Tensor, int]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of the converted tensor and the original last dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.divide_root_sum_of_squares">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">divide_root_sum_of_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel.divide_root_sum_of_squares"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.divide_root_sum_of_squares" title="Permalink to this definition"></a></dt>
<dd><p>Divide the input by the root of the sum of squares of the magnitude of each complex number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor to divide.</em>) – torch.Tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>RSS output tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masked_kspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_low_frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masked_kspace</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [batch_size, 1, n_x, n_y, 1]</p></li>
<li><p><strong>num_low_frequencies</strong> (<em>Number of low frequencies to keep.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Normalized UNet output tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.get_pad_and_num_low_freqs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pad_and_num_low_freqs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_low_frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/base.html#BaseSensitivityModel.get_pad_and_num_low_freqs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.get_pad_and_num_low_freqs" title="Permalink to this definition"></a></dt>
<dd><p>Get the padding to apply to the input to make it square and the number of low frequencies to keep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>Mask to use.</em>) – torch.Tensor</p></li>
<li><p><strong>num_low_frequencies</strong> (<em>Number of low frequencies to keep.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of the padding and the number of low frequencies to keep.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.base.BaseSensitivityModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.base.BaseSensitivityModel.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.ccnn">
<span id="mridc-collections-reconstruction-models-ccnn-module"></span><h2>mridc.collections.reconstruction.models.ccnn module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.ccnn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.ccnn.</span></span><span class="sig-name descname"><span class="pre">CascadeNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/ccnn.html#CascadeNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Deep Cascade of Convolutional Neural Networks, as presented in Schlemper, J.,     Caballero, J., Hajnal, J. V., Price, A., &amp; Rueckert, D.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Schlemper, J., Caballero, J., Hajnal, J. V., Price, A., &amp; Rueckert, D., A Deep Cascade of Convolutional         Neural Networks for MR Image Reconstruction. Information Processing in Medical Imaging (IPMI), 2017.         Available at: <a class="reference external" href="https://arxiv.org/pdf/1703.00555.pdf">https://arxiv.org/pdf/1703.00555.pdf</a></p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/ccnn.html#CascadeNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.ccnn.CascadeNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.ccnn.CascadeNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.cirim">
<span id="mridc-collections-reconstruction-models-cirim-module"></span><h2>mridc.collections.reconstruction.models.cirim module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.cirim" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.cirim.</span></span><span class="sig-name descname"><span class="pre">CIRIM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/cirim.html#CIRIM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Cascades of Independently Recurrent Inference Machines, as presented in     Karkalousos, D. et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Karkalousos, D. et al. (2021) ‘Assessment of Data Consistency through Cascades of Independently Recurrent         Inference Machines for fast and robust accelerated MRI reconstruction’. Available at:         <a class="reference external" href="https://arxiv.org/abs/2111.15498v1">https://arxiv.org/abs/2111.15498v1</a></p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Generator</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/cirim.html#CIRIM.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.process_intermediate_pred">
<span class="sig-name descname"><span class="pre">process_intermediate_pred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_coil_combination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/cirim.html#CIRIM.process_intermediate_pred"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.process_intermediate_pred" title="Permalink to this definition"></a></dt>
<dd><p>Process the intermediate prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>Intermediate prediction.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to crop to size.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>do_coil_combination</strong> (<em>Whether to do coil combination.</em>) – bool, default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – Processed prediction.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.process_loss">
<span class="sig-name descname"><span class="pre">process_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_loss_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/cirim.html#CIRIM.process_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.process_loss" title="Permalink to this definition"></a></dt>
<dd><p>Process the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>Target data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>pred</strong> (<em>Final prediction</em><em>(</em><em>s</em><em>)</em><em>.</em>) – list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or
torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>_loss_fn</strong> (<em>Loss function.</em>) – torch.nn.Module, default torch.nn.L1Loss()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>loss</strong> – If self.accumulate_loss is True, returns an accumulative result of all intermediate losses.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.FloatTensor, shape [1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.cirim.CIRIM.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.cirim.CIRIM.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.crnn">
<span id="mridc-collections-reconstruction-models-crnn-module"></span><h2>mridc.collections.reconstruction.models.crnn module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.crnn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.crnn.</span></span><span class="sig-name descname"><span class="pre">CRNNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/crnn.html#CRNNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Convolutional Recurrent Neural Network, inspired by C. Qin, J. Schlemper, J. Caballero,     A. N. Price, J. V. Hajnal and D. Rueckert.</p>
<p class="rubric">References</p>
<blockquote>
<div><ol class="upperalpha simple" start="3">
<li><p>Qin, J. Schlemper, J. Caballero, A. N. Price, J. V. Hajnal and D. Rueckert, “Convolutional Recurrent         Neural Networks for Dynamic MR Image Reconstruction,” in IEEE Transactions on Medical Imaging, vol. 38,         no. 1, pp. 280-290, Jan. 2019, doi: 10.1109/TMI.2018.2863670.</p></li>
</ol>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Generator</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/crnn.html#CRNNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.process_intermediate_pred">
<span class="sig-name descname"><span class="pre">process_intermediate_pred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/crnn.html#CRNNet.process_intermediate_pred"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.process_intermediate_pred" title="Permalink to this definition"></a></dt>
<dd><p>Process the intermediate prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred</strong> (<em>Intermediate prediction.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to crop to size.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – Processed prediction.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.process_loss">
<span class="sig-name descname"><span class="pre">process_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_loss_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/crnn.html#CRNNet.process_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.process_loss" title="Permalink to this definition"></a></dt>
<dd><p>Process the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>Target data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>pred</strong> (<em>Final prediction</em><em>(</em><em>s</em><em>)</em><em>.</em>) – list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or
torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>_loss_fn</strong> (<em>Loss function.</em>) – torch.nn.Module, default torch.nn.L1Loss()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>loss</strong> – If self.accumulate_loss is True, returns an accumulative result of all intermediate losses.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.FloatTensor, shape [1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.crnn.CRNNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.crnn.CRNNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.dunet">
<span id="mridc-collections-reconstruction-models-dunet-module"></span><h2>mridc.collections.reconstruction.models.dunet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.dunet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.dunet.</span></span><span class="sig-name descname"><span class="pre">DUNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/dunet.html#DUNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Down-Up NET, inspired by Hammernik, K, Schlemper, J, Qin, C, et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Hammernik, K, Schlemper, J, Qin, C, et al. Systematic evaluation of iterative deep neural networks for fast         parallel MRI reconstruction with sensitivity-weighted coil combination. Magn Reson Med. 2021; 86: 1859– 1872.          <a class="reference external" href="https://doi.org/10.1002/mrm.28827">https://doi.org/10.1002/mrm.28827</a></p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/dunet.html#DUNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.dunet.DUNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.dunet.DUNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.jointicnet">
<span id="mridc-collections-reconstruction-models-jointicnet-module"></span><h2>mridc.collections.reconstruction.models.jointicnet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.jointicnet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.jointicnet.</span></span><span class="sig-name descname"><span class="pre">JointICNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/jointicnet.html#JointICNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Joint Deep Model-Based MR Image and Coil Sensitivity Reconstruction Network (Joint-ICNet),     as presented in Jun, Yohan, et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Jun, Yohan, et al. “Joint Deep Model-Based MR Image and Coil Sensitivity Reconstruction Network (Joint-ICNet)          for Fast MRI.” 2021 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), IEEE, 2021, pp.           5266–75. DOI.org (Crossref), <a class="reference external" href="https://doi.org/10.1109/CVPR46437.2021.00523">https://doi.org/10.1109/CVPR46437.2021.00523</a>.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/jointicnet.html#JointICNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.update_C">
<span class="sig-name descname"><span class="pre">update_C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DC_sens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/jointicnet.html#JointICNet.update_C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.update_C" title="Permalink to this definition"></a></dt>
<dd><p>Update the coil sensitivity maps.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}C = (1 - 2 * \lambda_{k}^{C} * ni_{k}) * C_{k}\\C = 2 * \lambda_{k}^{C} * ni_{k} * D_{C}(F^-1(b))\\A(x_{k}) = M * F * (C * x_{k})\\C = 2 * ni_{k} * F^-1(M.T * (M * F * (C * x_{k}) - b)) * x_{k}^*\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – The current iteration index.</p></li>
<li><p><strong>DC_sens</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_sens_maps</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The initial coil sensitivity maps.</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_sens_maps</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The coil sensitivity maps.</p></li>
<li><p><strong>image</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The predicted image.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The subsampled k-space data.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>1</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The subsampled mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sensitivity_maps</strong> – The updated coil sensitivity maps.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor [batch_size, num_coils, num_sens_maps, num_rows, num_cols]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.jointicnet.JointICNet.update_X">
<span class="sig-name descname"><span class="pre">update_X</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/jointicnet.html#JointICNet.update_X"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.jointicnet.JointICNet.update_X" title="Permalink to this definition"></a></dt>
<dd><p>Update the image.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}x_{k} = (1 - 2 * \lamdba_{{k}_{I}} * mi_{k} - 2 * \lamdba_{{k}_{F}} * mi_{k}) * x_{k}\\x_{k} = 2 * mi_{k} * (\lambda_{{k}_{I}} * D_I(x_{k}) + \lambda_{{k}_{F}} * F^-1(D_F(f)))\\A(x{k} - b) = M * F * (C * x{k}) - b\\x_{k} = 2 * mi_{k} * A^* * (A(x{k} - b))\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – The current iteration index.</p></li>
<li><p><strong>image</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The predicted image.</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_sens_maps</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The coil sensitivity maps.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>num_coils</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The subsampled k-space data.</p></li>
<li><p><strong>mask</strong> (<em>torch.Tensor</em><em> [</em><em>batch_size</em><em>, </em><em>1</em><em>, </em><em>num_rows</em><em>, </em><em>num_cols</em><em>]</em>) – The subsampled mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>image</strong> – The updated image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor [batch_size, num_coils, num_rows, num_cols]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.kikinet">
<span id="mridc-collections-reconstruction-models-kikinet-module"></span><h2>mridc.collections.reconstruction.models.kikinet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.kikinet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.kikinet.</span></span><span class="sig-name descname"><span class="pre">KIKINet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/kikinet.html#KIKINet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Based on KIKINet implementation [1]. Modified to work with multi-coil k-space data, as presented in Eo, Taejoon,     et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Eo, Taejoon, et al. “KIKI-Net: Cross-Domain Convolutional Neural Networks for Reconstructing Undersampled         Magnetic Resonance Images.” Magnetic Resonance in Medicine, vol. 80, no. 5, Nov. 2018, pp. 2188–201. PubMed,         <a class="reference external" href="https://doi.org/10.1002/mrm.27201">https://doi.org/10.1002/mrm.27201</a>.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/kikinet.html#KIKINet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.kikinet.KIKINet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.kikinet.KIKINet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.lpd">
<span id="mridc-collections-reconstruction-models-lpd-module"></span><h2>mridc.collections.reconstruction.models.lpd module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.lpd" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.lpd.</span></span><span class="sig-name descname"><span class="pre">LPDNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/lpd.html#LPDNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Learned Primal Dual network, inspired by Adler, Jonas, and Ozan Öktem.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Adler, Jonas, and Ozan Öktem. “Learned Primal-Dual Reconstruction.” IEEE Transactions on Medical Imaging,         vol. 37, no. 6, June 2018, pp. 1322–32. arXiv.org, <a class="reference external" href="https://doi.org/10.1109/TMI.2018.2799231">https://doi.org/10.1109/TMI.2018.2799231</a>.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/lpd.html#LPDNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.lpd.LPDNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.lpd.LPDNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.multidomainnet">
<span id="mridc-collections-reconstruction-models-multidomainnet-module"></span><h2>mridc.collections.reconstruction.models.multidomainnet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.multidomainnet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.multidomainnet.</span></span><span class="sig-name descname"><span class="pre">MultiDomainNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/multidomainnet.html#MultiDomainNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Feature-level multi-domain module. Inspired by AIRS Medical submission to the FastMRI 2020 challenge.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/multidomainnet.html#MultiDomainNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.multidomainnet.MultiDomainNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.pics">
<span id="mridc-collections-reconstruction-models-pics-module"></span><h2>mridc.collections.reconstruction.models.pics module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.pics" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.pics.</span></span><span class="sig-name descname"><span class="pre">PICS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/pics.html#PICS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Parallel-Imaging Compressed Sensing (PICS) reconstruction using the BART by Uecker, M. et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Uecker, M. et al. (2015) ‘Berkeley Advanced Reconstruction Toolbox’, Proc. Intl. Soc. Mag. Reson. Med., 23.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/pics.html#PICS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of PICS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – Predicted data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.process_inputs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/pics.html#PICS.process_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.process_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Process the inputs to the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – list of torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – list of torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – randomly selected y</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – randomly selected mask</p></li>
<li><p><strong>r</strong> (<em>Random index.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/pics.html#PICS.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Test step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Batch of data.</em>) – Dict of torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>batch_idx</strong> (<em>Batch index.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>name</strong> (<em>Name of the volume.</em>) – str</p></li>
<li><p><strong>slice_num</strong> (<em>Slice number.</em>) – int</p></li>
<li><p><strong>pred</strong> (<em>Predicted data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.pics.PICS.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.pics.PICS.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.rvn">
<span id="mridc-collections-reconstruction-models-rvn-module"></span><h2>mridc.collections.reconstruction.models.rvn module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.rvn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.rvn.</span></span><span class="sig-name descname"><span class="pre">RecurrentVarNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/rvn.html#RecurrentVarNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Recurrent Variational Network implementation, as presented in Yiasemis, George, et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Yiasemis, George, et al. “Recurrent Variational Network: A Deep Learning Inverse Problem Solver Applied to         the Task of Accelerated MRI Reconstruction.” ArXiv:2111.09639 [Physics], Nov. 2021. arXiv.org,         http://arxiv.org/abs/2111.09639.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/rvn.html#RecurrentVarNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.rvn.RecurrentVarNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.rvn.RecurrentVarNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.unet">
<span id="mridc-collections-reconstruction-models-unet-module"></span><h2>mridc.collections.reconstruction.models.unet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.unet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.unet.</span></span><span class="sig-name descname"><span class="pre">UNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/unet.html#UNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the UNet, as presented in O. Ronneberger, P. Fischer, and Thomas Brox.</p>
<p class="rubric">References</p>
<blockquote>
<div><ol class="upperalpha simple" start="15">
<li><p>Ronneberger, P. Fischer, and Thomas Brox. U-net: Convolutional networks for biomedical image segmentation.          In International Conference on Medical image computing and computer-assisted intervention, pages 234–241.           Springer, 2015.</p></li>
</ol>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/unet.html#UNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.unet.UNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.unet.UNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.vn">
<span id="mridc-collections-reconstruction-models-vn-module"></span><h2>mridc.collections.reconstruction.models.vn module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.vn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.vn.</span></span><span class="sig-name descname"><span class="pre">VarNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/vn.html#VarNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the End-to-end Variational Network (VN), as presented in Sriram, A. et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Sriram, A. et al. (2020) ‘End-to-End Variational Networks for Accelerated MRI Reconstruction’. Available         at: <a class="reference external" href="https://github.com/facebookresearch/fastMRI">https://github.com/facebookresearch/fastMRI</a>.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/vn.html#VarNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vn.VarNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vn.VarNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.vsnet">
<span id="mridc-collections-reconstruction-models-vsnet-module"></span><h2>mridc.collections.reconstruction.models.vsnet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.vsnet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.vsnet.</span></span><span class="sig-name descname"><span class="pre">VSNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/vsnet.html#VSNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the Variable-Splitting Net, as presented in Duan, J. et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Duan, J. et al. (2019) ‘Vs-net: Variable splitting network for accelerated parallel MRI reconstruction’,         Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture         Notes in Bioinformatics), 11767 LNCS, pp. 713–722. doi: 10.1007/978-3-030-32251-9_78.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/vsnet.html#VSNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.vsnet.VSNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.vsnet.VSNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.xpdnet">
<span id="mridc-collections-reconstruction-models-xpdnet-module"></span><h2>mridc.collections.reconstruction.models.xpdnet module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.xpdnet" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.xpdnet.</span></span><span class="sig-name descname"><span class="pre">XPDNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/xpdnet.html#XPDNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Implementation of the XPDNet, as presented in Ramzi, Zaccharie, et al.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Ramzi, Zaccharie, et al. “XPDNet for MRI Reconstruction: An Application to the 2020 FastMRI Challenge.         ” ArXiv:2010.07290 [Physics, Stat], July 2021. arXiv.org, http://arxiv.org/abs/2010.07290.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/xpdnet.html#XPDNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – If self.accumulate_loss is True, returns a list of all intermediate estimates.
If False, returns the final estimate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of torch.Tensor, shape [batch_size, n_x, n_y, 2], or  torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.xpdnet.XPDNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.xpdnet.XPDNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models.zf">
<span id="mridc-collections-reconstruction-models-zf-module"></span><h2>mridc.collections.reconstruction.models.zf module<a class="headerlink" href="#module-mridc.collections.reconstruction.models.zf" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mridc.collections.reconstruction.models.zf.</span></span><span class="sig-name descname"><span class="pre">ZF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">omegaconf.dictconfig.DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pytorch_lightning.trainer.trainer.Trainer</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/zf.html#ZF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel" title="mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">mridc.collections.reconstruction.models.base.BaseMRIReconstructionModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Zero-Filled reconstruction using either root-sum-of-squares (RSS) or SENSE (SENSitivity Encoding), as presented     in Pruessmann KP, Weiger M, Scheidegger MB, Boesiger P.</p>
<p class="rubric">References</p>
<blockquote>
<div><p>Pruessmann KP, Weiger M, Scheidegger MB, Boesiger P. SENSE: Sensitivity encoding for fast MRI. Magn Reson         Med 1999; 42:952-962.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.allow_zero_length_dataloader_with_multiple_devices">
<span class="sig-name descname"><span class="pre">allow_zero_length_dataloader_with_multiple_devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.allow_zero_length_dataloader_with_multiple_devices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/zf.html#ZF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass of the zero-filled method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>sensitivity_maps</strong> (<em>Coil sensitivity maps.</em>) – torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
<li><p><strong>init_pred</strong> (<em>Initial prediction.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
<li><p><strong>target</strong> (<em>Target data to compute the loss.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pred</strong> – Predicted data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor, shape [batch_size, n_x, n_y, 2]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.mse_vals">
<span class="sig-name descname"><span class="pre">mse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.mse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.nmse_vals">
<span class="sig-name descname"><span class="pre">nmse_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.nmse_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.precision" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.prepare_data_per_node">
<span class="sig-name descname"><span class="pre">prepare_data_per_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.prepare_data_per_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.process_inputs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/zf.html#ZF.process_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.process_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Process the inputs to the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – list of torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – list of torch.Tensor, shape [1, 1, n_x, n_y, 1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>Subsampled k-space data.</em>) – randomly selected y</p></li>
<li><p><strong>mask</strong> (<em>Sampling mask.</em>) – randomly selected mask</p></li>
<li><p><strong>r</strong> (<em>Random index.</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.psnr_vals">
<span class="sig-name descname"><span class="pre">psnr_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.psnr_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.ssim_vals">
<span class="sig-name descname"><span class="pre">ssim_vals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.ssim_vals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mridc/collections/reconstruction/models/zf.html#ZF.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Test step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Batch of data.</em>) – Dict of torch.Tensor, shape [batch_size, n_coils, n_x, n_y, 2]</p></li>
<li><p><strong>batch_idx</strong> (<em>Batch index.</em>) – int</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>name</strong> (<em>Name of the volume.</em>) – str</p></li>
<li><p><strong>slice_num</strong> (<em>Slice number.</em>) – int</p></li>
<li><p><strong>pred</strong> (<em>Predicted data.</em>) – torch.Tensor, shape [batch_size, n_x, n_y, 2]</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.trainer">
<span class="sig-name descname"><span class="pre">trainer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pl.Trainer'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.trainer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mridc.collections.reconstruction.models.zf.ZF.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mridc.collections.reconstruction.models.zf.ZF.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-mridc.collections.reconstruction.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mridc.collections.reconstruction.models" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mridc.collections.reconstruction.metrics.html" class="btn btn-neutral float-left" title="mridc.collections.reconstruction.metrics package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mridc.collections.reconstruction.models.cascadenet.html" class="btn btn-neutral float-right" title="mridc.collections.reconstruction.models.cascadenet package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Dimitrios Karkalousos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
